<!DOCTYPE html><html><head><style>p {font-family: verdana;font-size: 400px;color: #FFFFFF;}</style>

<title>Compass</title>

<script>  
// Get event data  
function deviceOrientationListener(event) {  
  var alpha    = event.alpha; //z axis rotation \[0,360)  
  var beta     = event.beta; //x axis rotation \[-180, 180\]  
  var gamma    = event.gamma; //y axis rotation \[-90, 90\]

  //Check if absolute values have been sent  
  if (typeof event.webkitCompassHeading !== "undefined") {  
    alpha = event.webkitCompassHeading; //iOS non-standard  
    var heading = alpha  
    document.getElementById("heading").innerHTML = heading.toFixed(\[0\]);  
  }  
  else {  
    alert("Your device is reporting relative alpha values, so this compass won't point north :(");  
    var heading = 360 - alpha; //heading \[0, 360)  
    document.getElementById("heading").innerHTML = heading.toFixed(\[0\]);  
  }  
    
  // Change backgroud colour based on heading  
  // Green for North and South, black otherwise  
  if (heading > 359 || heading < 1) { //Allow +- 1 degree  
    document.body.style.backgroundColor = "green";  
    document.getElementById("heading").innerHTML = "N"; // North  
  }  
  else if (heading > 179 && heading < 181){ //Allow +- 1 degree  
    document.body.style.backgroundColor = "green";  
    document.getElementById("heading").innerHTML = "S"; // South  
  }   
  else { // Otherwise, use near black  
    document.body.style.backgroundColor = "#161616";  
  }  
}  
  
// Check if device can provide absolute orientation data  
if (window.DeviceOrientationAbsoluteEvent) {  
  window.addEventListener("DeviceOrientationAbsoluteEvent", deviceOrientationListener);  
} // If not, check if the device sends any orientation data  
else if(window.DeviceOrientationEvent){  
  window.addEventListener("deviceorientation", deviceOrientationListener);  
} // Send an alert if the device isn't compatible  
else {  
  alert("Sorry, try again on a compatible mobile device!");  
}  
</script>  
</head>

<body><br><br><p id="heading" style="text-align:center"></p></body>
</html>

<!-- <!DOCTYPE html>
<html>
<head>
  <title>Fusion Compass</title>  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="UTF-8">
</head>
<body>
  <h1>Compass with OrientationSensor</h1>
    <div id="status"></div>

    <div id="compassContainer">
    <img src="https://purepng.com/public/uploads/large/purepng.com-compasscompassinstrumentnavigationcardinal-directionspointsdiagram-1701527842316onq7x.png" id="compass" hidden/>
    </div>

    <script>
      let compass = document.getElementById('compass');
      let status  = document.getElementById('status');

      if ( 'AbsoluteOrientationSensor' in window ) {
        compass.hidden = false;     
        let sensor = new AbsoluteOrientationSensor();
        sensor.addEventListener('reading', function(e) {
          let q = e.target.quaternion;
          heading = Math.atan2(2*q[0]*q[1] + 2*q[2]*q[3], 1 - 2*q[1]*q[1] - 2*q[2]*q[2])*(180/Math.PI);

          let html =  'Heading in degrees: ' + heading;
          //if(heading < 0) heading = 360 + heading;
          var headingAdjusted = 270 + heading;
          
          //heading - 90;
          console.log('adjusted heading Before: ' + headingAdjusted);
          //headingAdjusted + 90;
          //if(headingAdjusted > 360) headingAdjusted = headingAdjusted - 90;
          console.log('adjusted heading After: ' + headingAdjusted);
          //var test = 90 + headingAdjusted;
          //var test = 80;
          html += '<br>Adjusted:   ' + headingAdjusted;
          status.innerHTML = html;
          compass.style.Transform = 'rotate(' + headingAdjusted + 'deg)';
          compass.style.WebkitTransform = 'rotate('+ headingAdjusted + 'deg)';
          //compass.style.MozTransform = 'rotate(' + 90 + 'deg)';
        });
        sensor.start();
      }
      else status.innerHTML = 'AbsoluteOrientationSensor not supported';

    </script>
    <style>#compass{width:100%;max-width:400px;}</style>

</body>
</html>




 -->
